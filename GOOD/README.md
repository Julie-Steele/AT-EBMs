Adapted from https://gitlab.com/Bitterwolf/GOOD/-/tree/master/tiny_utils
